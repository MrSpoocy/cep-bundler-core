{"version":3,"file":"cep-bundler-core.cjs.js","sources":["../src/templates/manifest.js","../src/templates/html.js","../src/templates/.debug.js","../src/index.js"],"sourcesContent":["export default ({\n  bundleName = 'My Extension',\n  bundleId = 'com.test.test.extension',\n  version = '1.0.0',\n  hosts,\n  bundleVersion = '1.0.0',\n  cepVersion = '6.0',\n  panelWidth = '500',\n  panelHeight = '500',\n  cefParams = [\n    '--allow-file-access-from-files',\n    '--allow-file-access',\n    '--enable-nodejs',\n  ],\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover,\n  lifecycle,\n}) => {\n  var commandLineParams = cefParams.map(\n    cefParam => `<Parameter>${cefParam}</Parameter>`\n  )\n\n  var icons = [\n    { icon: iconNormal, type: 'Normal' },\n    { icon: iconRollover, type: 'RollOver' },\n    { icon: iconDarkNormal, type: 'DarkNormal' },\n    { icon: iconDarkRollover, type: 'DarkRollOver' },\n  ]\n    .filter(({ icon }) => !!icon)\n    .map(({ icon, type }) => `<Icon Type=\"${type}\">${icon}</Icon>`)\n    .join('\\n            ')\n\n  var startOn = (!lifecycle.startOnEvents || lifecycle.startOnEvents.length === 0) ? '' : `\n          <StartOn>\n            ${lifecycle.startOnEvents.map(e => `<Event>${e}</Event>`).join('\\n            ')}\n          </StartOn>`;\n\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<ExtensionManifest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ExtensionBundleId=\"${bundleId}\" ExtensionBundleName=\"${bundleName}\" ExtensionBundleVersion=\"${bundleVersion}\" Version=\"${cepVersion}\">\n  <ExtensionList>\n    <Extension Id=\"${bundleId}\" Version=\"${version}\"/>\n  </ExtensionList>\n  <ExecutionEnvironment>\n    <HostList>\n      ${hosts\n        .map(host => `<Host Name=\"${host.name}\" Version=\"${host.version}\" />`)\n        .join('\\n      ')}\n    </HostList>\n    <LocaleList>\n      <Locale Code=\"All\"/>\n    </LocaleList>\n    <RequiredRuntimeList>\n      <RequiredRuntime Name=\"CSXS\" Version=\"${cepVersion}\"/>\n    </RequiredRuntimeList>\n  </ExecutionEnvironment>\n  <DispatchInfoList>\n    <Extension Id=\"${bundleId}\">\n      <DispatchInfo>\n        <Resources>\n          <MainPath>./panel.html</MainPath>\n          <CEFCommandLine>\n            ${commandLineParams.join('\\n            ')}\n          </CEFCommandLine>\n        </Resources>\n        <Lifecycle>\n          <AutoVisible>${lifecycle.autoVisible}</AutoVisible>${startOn}\n        </Lifecycle>\n        <UI>\n          <Type>Panel</Type>\n          <Menu>${bundleName}</Menu>\n          <Geometry>\n            <Size>\n              <Width>${panelWidth}</Width>\n              <Height>${panelHeight}</Height>\n            </Size>\n          </Geometry>\n          <Icons>\n            ${icons}\n          </Icons>\n        </UI>\n      </DispatchInfo>\n    </Extension>\n  </DispatchInfoList>\n</ExtensionManifest>`\n}","export default ({ title = 'CEP Panel', href }) => {\n  return `<!DOCTYPE html>\n<html>\n  <head>\n    <title>${title}</title>\n  </head>\n  <body>\n    <script>\n      window.location.href = \"${href}\";\n    </script>\n  </body>\n</html>`\n}","export default (bundleId = 'com.test.extension', hosts) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ExtensionList>\n  <Extension Id=\"${bundleId}\">\n  <HostList>\n    ${hosts\n      .map(\n        (host, i) =>\n          `<Host Name=\"${host.name.trim()}\" Port=\"${'' + (3000 + i + 1)}\" />`\n      )\n      .join('\\n    ')}\n  </HostList>\n  </Extension>\n</ExtensionList>`\n}\n","import os from 'os'\nimport path from 'path'\nimport { execSync } from 'child_process'\nimport fs from 'fs-extra'\nimport { range, defaultsDeep } from 'lodash'\n\nimport manifestTemplate from './templates/manifest'\nimport panelTemplate from './templates/html'\nimport debugTemplate from './templates/.debug'\n\nfunction templateDebug(formatter) {\n  return range(4, 16)\n    .map(formatter)\n    .join(os.EOL)\n}\n\nexport function enablePlayerDebugMode() {\n  // enable unsigned extensions for the foreseable future\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 1`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG ADD HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode /t REG_SZ /d 1`\n      )\n    )\n  }\n}\n\nexport function disablePlayerDebugMode() {\n  // disable unsigned extensions for the foreseable future\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 0`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG DELETE HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode`\n      )\n    )\n  }\n}\n\nfunction camelToSnake(str) {\n  return str.replace(/([A-Z])/g, (part) => `_${part.toLowerCase()}`)\n}\n\nfunction isTruthy(str) {\n  return typeof str === 'string' && (str === '1' || str.toLowerCase() === 'true')\n}\n\nexport function getConfig(pkg) {\n  const debugPortEnvs = Object.keys(process.env)\n    .filter((key) => key.indexOf('DEBUG_PORT_') === 0)\n  if (!pkg.cep) {\n    pkg.cep = {}\n  }\n  const config = defaultsDeep(\n    {\n      bundleName: process.env.NAME,\n      bundleId: process.env.ID,\n      bundleVersion: process.env.VERSION,\n      hosts: process.env.HOSTS,\n      iconNormal: process.env.ICON_NORMAL,\n      iconRollover: process.env.ICON_ROLLOVER,\n      iconDarkNormal: process.env.ICON_DARK_NORMAL,\n      iconDarkRollover: process.env.ICON_DARK_ROLLOVER,\n      panelWidth: process.env.PANEL_WIDTH,\n      panelHeight: process.env.PANEL_HEIGHT,\n      debugPorts: debugPortEnvs.length > 0\n        ? debugPortEnvs.reduce((obj, key) => {\n          obj[key] = parseInt(process.env[key], 10)\n          return obj\n        }, {})\n        : undefined,\n      debugInProduction: isTruthy(process.env.DEBUG_IN_PRODUCTION),\n      cefParams: !process.env.CEF_PARAMS ? undefined : process.env.CEF_PARAMS.split(',')\n    },\n    {\n      bundleName: pkg.cep && pkg.cep.name,\n      bundleId: pkg.cep && pkg.cep.id,\n      bundleVersion: pkg.cep && pkg.cep.version,\n      hosts: pkg.cep && pkg.cep.hosts,\n      iconNormal: pkg.cep.iconNormal,\n      iconRollover: pkg.cep.iconRollover,\n      iconDarkNormal: pkg.cep.iconDarkNormal,\n      iconDarkRollover: pkg.cep.iconDarkRollover,\n      panelWidth: pkg.cep.panelWidth,\n      panelHeight: pkg.cep.panelHeight,\n      debugPorts: pkg.cep.debugPorts,\n      debugInProduction: pkg.cep.debugInProduction,\n      lifecycle: pkg.cep.lifecycle,\n      cefParams: pkg.cep.cefParams\n    },\n    {\n      bundleVersion: pkg.version,\n    },\n    {\n      bundleName: 'Parcel CEP Extension',\n      bundleId: 'com.mycompany.myextension',\n      bundleVersion: '0.0.1',\n      hosts: '*',\n      panelWidth: 500,\n      panelHeight: 500,\n      debugInProduction: false,\n      debugPorts: {\n        PHXS: 3001,\n        IDSN: 3002,\n        AICY: 3003,\n        ILST: 3004,\n        PPRO: 3005,\n        PRLD: 3006,\n        AEFT: 3007,\n        FLPR: 3008,\n        AUDT: 3009,\n        DRWV: 3010,\n        MUST: 3011,\n        KBRG: 3012,\n      },\n      lifecycle: { autoVisible: true, startOnEvents: [] },\n      cefParams: [\n        '--allow-file-access-from-files',\n        '--allow-file-access',\n        '--enable-nodejs',\n        '--mixed-context'\n      ]\n    }\n  )\n  return config\n}\n\nexport function objectToProcessEnv(object) {\n  // assign object to process.env so they can be used in the code\n  Object.keys(object).forEach(key => {\n    const envKey = camelToSnake(key).toUpperCase()\n    const value = typeof object[key] === 'string'\n      ? object[key]\n      : JSON.stringify(object[key])\n    process.env[envKey] = value\n  })\n}\n\nexport function writeExtensionTemplates({\n  env,\n  port,\n  hosts,\n  out,\n  htmlFilename,\n  bundleName,\n  bundleId,\n  bundleVersion,\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover,\n  panelWidth,\n  panelHeight,\n  debugInProduction,\n  lifecycle,\n  cefParams\n}) {\n  const manifestContents = manifestTemplate({\n    bundleName,\n    bundleId,\n    version: bundleVersion,\n    hosts,\n    bundleVersion,\n    iconNormal,\n    iconRollover,\n    iconDarkNormal,\n    iconDarkRollover,\n    panelWidth,\n    panelHeight,\n    lifecycle,\n    cefParams\n  })\n  const manifestDir = path.join(out, 'CSXS')\n  const manifestFile = path.join(manifestDir, 'manifest.xml')\n  return Promise.resolve()\n    .then(() => fs.ensureDir(manifestDir))\n    .then(() => fs.writeFile(manifestFile, manifestContents))\n    .then(() => {\n      let chain = Promise.resolve()\n      if (debugInProduction || env !== 'production') {\n        const debugContents = debugTemplate(bundleId, hosts)\n        chain = chain.then(() => fs.writeFile(path.join(out, '.debug'), debugContents))\n      }\n      const href = env == 'production' ? htmlFilename : `http://localhost:${port}`\n      const panelContents = panelTemplate({\n        title: bundleName,\n        href\n      })\n      chain = chain.then(() => fs.writeFile(path.join(out, 'panel.html'), panelContents))\n      return chain\n    })\n}\n\nexport function parseHosts(hostsString) {\n  if (hostsString == '*')\n    hostsString = `PHXS, IDSN, AICY, ILST, PPRO, PRLD, AEFT, FLPR, AUDT, DRWV, MUST, KBRG`\n  const hosts = hostsString\n    .split(/(?![^)(]*\\([^)(]*?\\)\\)),(?![^\\[]*\\])/)\n    .map(host => host.trim())\n    .map(host => {\n      let [name, version] = host.split('@')\n      if (version == '*' || !version) {\n        version = '[0.0,99.9]'\n      } else if (version) {\n        version = version\n      }\n      return {\n        name,\n        version,\n      }\n    })\n  return hosts\n}\n\nexport function getExtenstionPath() {\n  if (process.platform == 'darwin') {\n    return path.join(\n      os.homedir(),\n      '/Library/Application Support/Adobe/CEP/extensions'\n    )\n  } else if (process.platform == 'win32') {\n    return path.join(process.env.APPDATA, 'Adobe/CEP/extensions')\n  }\n}\n\nfunction getSymlinkExtensionPath({ bundleId }) {\n  const extensionPath = getExtenstionPath()\n  return path.join(extensionPath, bundleId)\n}\n\nexport function symlinkExtension({ bundleId, out }) {\n  const target = getSymlinkExtensionPath({ bundleId })\n  return Promise.resolve()\n    .then(() => fs.ensureDir(getExtenstionPath()))\n    .then(() => fs.remove(target))\n    .then(() => {\n      if (process.platform === 'win32') {\n        return fs.symlink(path.join(out, '/'), target, 'junction')\n      } else {\n        return fs.symlink(path.join(out, '/'), target)\n      }\n    })\n}\n\nexport function copyDependencies({ root, out, pkg }) {\n  return Promise.resolve()\n    .then(() => {\n      let chain = Promise.resolve()\n      const deps = pkg.dependencies || {}\n      Object.keys(deps).forEach(dep => {\n        try {\n          const src = path.join(root, 'node_modules', dep)\n          const dest = path.join(out, 'node_modules', dep)\n          if (!fs.existsSync(dest)) {\n            chain = chain.then(() => {\n              if (!fs.existsSync(dest)) {\n                return fs.copy(src, dest)\n              }\n            })\n          }\n        } catch (err) {\n          console.error('Error while copying', err)\n        }\n        chain = chain.then(() => copyDependencies({\n          root,\n          out,\n          pkg: fs.readJsonSync(path.join(root, 'node_modules', dep, 'package.json'))\n        }))\n      })\n      return chain\n    })\n}\n\nexport function copyIcons({ root, out, config }) {\n  const iconPaths = [\n    config.iconNormal,\n    config.iconRollover,\n    config.iconDarkNormal,\n    config.iconDarkRollover,\n  ]\n    .filter(icon => icon !== undefined)\n    .map(icon => ({\n        source: path.resolve(root, icon),\n        output: path.join(out, path.relative(root, icon)),\n    }))\n  return Promise.all(\n    iconPaths.map(icon => {\n      return fs.copy(icon.source, icon.output)\n        .catch(() => {\n          console.error(\n            `Could not copy ${icon.source}. Ensure the path is correct.`\n          )\n        })\n    })\n  )\n}\n\nexport function compile(opts) {\n  opts.env = opts.hasOwnProperty('env') ? opts.env : process.env.NODE_ENV\n  opts.root = opts.hasOwnProperty('root') ? opts.root : process.cwd()\n  opts.htmlFilename = opts.hasOwnProperty('htmlFilename') ? opts.htmlFilename : 'index.html'\n  opts.pkg = opts.hasOwnProperty('pkg') ? opts.pkg : require(path.join(opts.root, '/package.json'))\n  const config = getConfig(opts.pkg)\n  const hosts = parseHosts(config.hosts)\n  let chain = Promise.resolve()\n  if (opts.env === 'development') {\n    enablePlayerDebugMode()\n    if (!config.noSymlink) {\n      chain = chain.then(() =>\n        symlinkExtension({ bundleId: config.bundleId, out: opts.out })\n      )\n    }\n  }\n  chain = chain.then(() =>\n    copyDependencies({ root: opts.root, out: opts.out, pkg: opts.pkg })\n  ).then(() =>\n    writeExtensionTemplates({\n      env: opts.env,\n      hosts,\n      port: opts.devPort,\n      htmlFilename: opts.htmlFilename,\n      bundleName: config.bundleName,\n      bundleId: config.bundleId,\n      bundleVersion: config.bundleVersion,\n      iconNormal: config.iconNormal,\n      iconRollover: config.iconRollover,\n      iconDarkNormal: config.iconDarkNormal,\n      iconDarkRollover: config.iconDarkRollover,\n      panelWidth: config.panelWidth,\n      panelHeight: config.panelHeight,\n      debugInProduction: config.debugInProduction,\n      cefParams: config.cefParams,\n      lifecycle: config.lifecycle,\n      cefParams: config.cefParams,\n      out: opts.out,\n    })\n  )\n  .then(() =>\n    copyIcons({ root: opts.root, out: opts.out, config })\n  )\n  return chain\n}"],"names":["bundleName","bundleId","version","hosts","bundleVersion","cepVersion","panelWidth","panelHeight","cefParams","iconNormal","iconRollover","iconDarkNormal","iconDarkRollover","lifecycle","commandLineParams","map","cefParam","icons","icon","type","filter","join","startOn","startOnEvents","length","e","host","name","autoVisible","title","href","i","trim","templateDebug","formatter","range","os","EOL","enablePlayerDebugMode","process","platform","execSync","disablePlayerDebugMode","camelToSnake","str","replace","part","toLowerCase","isTruthy","getConfig","pkg","debugPortEnvs","Object","keys","env","key","indexOf","cep","config","defaultsDeep","NAME","ID","VERSION","HOSTS","ICON_NORMAL","ICON_ROLLOVER","ICON_DARK_NORMAL","ICON_DARK_ROLLOVER","PANEL_WIDTH","PANEL_HEIGHT","debugPorts","reduce","obj","parseInt","undefined","debugInProduction","DEBUG_IN_PRODUCTION","CEF_PARAMS","split","id","PHXS","IDSN","AICY","ILST","PPRO","PRLD","AEFT","FLPR","AUDT","DRWV","MUST","KBRG","objectToProcessEnv","object","forEach","envKey","toUpperCase","value","JSON","stringify","writeExtensionTemplates","port","out","htmlFilename","manifestContents","manifestTemplate","manifestDir","path","manifestFile","Promise","resolve","then","fs","ensureDir","writeFile","chain","debugContents","debugTemplate","panelContents","panelTemplate","parseHosts","hostsString","getExtenstionPath","homedir","APPDATA","getSymlinkExtensionPath","extensionPath","symlinkExtension","target","remove","symlink","copyDependencies","root","deps","dependencies","dep","src","dest","existsSync","copy","err","console","error","readJsonSync","copyIcons","iconPaths","source","output","relative","all","compile","opts","hasOwnProperty","NODE_ENV","cwd","require","noSymlink","devPort"],"mappings":"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"}