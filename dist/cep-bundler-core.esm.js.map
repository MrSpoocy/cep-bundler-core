{"version":3,"file":"cep-bundler-core.esm.js","sources":["../src/templates/manifest.js","../src/templates/html.js","../src/templates/.debug.js","../src/index.js"],"sourcesContent":["export default ({\n  bundleName = 'My Extension',\n  bundleId = 'com.test.test.extension',\n  version = '1.0.0',\n  hosts,\n  bundleVersion = '1.0.0',\n  cepVersion = '6.0',\n  panelWidth = '500',\n  panelHeight = '500',\n  cefParams = [\n    '--allow-file-access-from-files',\n    '--allow-file-access',\n    '--enable-nodejs',\n  ],\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover,\n  lifecycle,\n}) => {\n  var commandLineParams = cefParams.map(\n    cefParam => `<Parameter>${cefParam}</Parameter>`\n  )\n\n  var icons = [\n    { icon: iconNormal, type: 'Normal' },\n    { icon: iconRollover, type: 'RollOver' },\n    { icon: iconDarkNormal, type: 'DarkNormal' },\n    { icon: iconDarkRollover, type: 'DarkRollOver' },\n  ]\n    .filter(({ icon }) => !!icon)\n    .map(({ icon, type }) => `<Icon Type=\"${type}\">${icon}</Icon>`)\n    .join('\\n            ')\n\n  var startOn = (!lifecycle.startOnEvents || lifecycle.startOnEvents.length === 0) ? '' : `\n          <StartOn>\n            ${lifecycle.startOnEvents.map(e => `<Event>${e}</Event>`).join('\\n            ')}\n          </StartOn>`;\n\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<ExtensionManifest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ExtensionBundleId=\"${bundleId}\" ExtensionBundleName=\"${bundleName}\" ExtensionBundleVersion=\"${bundleVersion}\" Version=\"${cepVersion}\">\n  <ExtensionList>\n    <Extension Id=\"${bundleId}\" Version=\"${version}\"/>\n  </ExtensionList>\n  <ExecutionEnvironment>\n    <HostList>\n      ${hosts\n        .map(host => `<Host Name=\"${host.name}\" Version=\"${host.version}\" />`)\n        .join('\\n      ')}\n    </HostList>\n    <LocaleList>\n      <Locale Code=\"All\"/>\n    </LocaleList>\n    <RequiredRuntimeList>\n      <RequiredRuntime Name=\"CSXS\" Version=\"${cepVersion}\"/>\n    </RequiredRuntimeList>\n  </ExecutionEnvironment>\n  <DispatchInfoList>\n    <Extension Id=\"${bundleId}\">\n      <DispatchInfo>\n        <Resources>\n          <MainPath>./panel.html</MainPath>\n          <CEFCommandLine>\n            ${commandLineParams.join('\\n            ')}\n          </CEFCommandLine>\n        </Resources>\n        <Lifecycle>\n          <AutoVisible>${lifecycle.autoVisible}</AutoVisible>${startOn}\n        </Lifecycle>\n        <UI>\n          <Type>Panel</Type>\n          <Menu>${bundleName}</Menu>\n          <Geometry>\n            <Size>\n              <Width>${panelWidth}</Width>\n              <Height>${panelHeight}</Height>\n            </Size>\n          </Geometry>\n          <Icons>\n            ${icons}\n          </Icons>\n        </UI>\n      </DispatchInfo>\n    </Extension>\n  </DispatchInfoList>\n</ExtensionManifest>`\n}","export default ({ title = 'CEP Panel', href }) => {\n  return `<!DOCTYPE html>\n<html>\n  <head>\n    <title>${title}</title>\n  </head>\n  <body>\n    <script>\n      window.location.href = \"${href}\";\n    </script>\n  </body>\n</html>`\n}","export default (bundleId = 'com.test.extension', debugPorts) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ExtensionList>\n  <Extension Id=\"${bundleId}\">\n  <HostList>\n    ${Object.keys(debugPorts)\n      .map(\n        (host) =>\n          `<Host Name=\"${host.name.trim()}\" Port=\"${debugPorts[host]}\" />`\n      )\n      .join('\\n    ')}\n  </HostList>\n  </Extension>\n</ExtensionList>`\n}\n","import os from 'os'\nimport path from 'path'\nimport { execSync } from 'child_process'\nimport fs from 'fs-extra'\nimport { range, defaultsDeep } from 'lodash'\n\nimport manifestTemplate from './templates/manifest'\nimport panelTemplate from './templates/html'\nimport debugTemplate from './templates/.debug'\n\nfunction templateDebug(formatter) {\n  return range(4, 16)\n    .map(formatter)\n    .join(os.EOL)\n}\n\nexport function enablePlayerDebugMode() {\n  // enable unsigned extensions for the foreseable future\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 1`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG ADD HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode /t REG_SZ /d 1`\n      )\n    )\n  }\n}\n\nexport function disablePlayerDebugMode() {\n  // disable unsigned extensions for the foreseable future\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 0`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG DELETE HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode`\n      )\n    )\n  }\n}\n\nfunction camelToSnake(str) {\n  return str.replace(/([A-Z])/g, (part) => `_${part.toLowerCase()}`)\n}\n\nfunction isTruthy(str) {\n  return typeof str === 'string' && (str === '1' || str.toLowerCase() === 'true')\n}\n\nexport function getConfig(pkg, env) {\n  const debugPortEnvs = Object.keys(process.env)\n    .filter((key) => key.indexOf('CEP_DEBUG_PORT_') === 0)\n  const pkgConfig = pkg.hasOwnProperty('cep')\n    ? (\n      pkg.cep.hasOwnProperty(env)\n        ? pkg.cep.env\n        : pkg.cep\n      )\n    : {}\n  const config = defaultsDeep(\n    {\n      bundleName: process.env.CEP_NAME,\n      bundleId: process.env.CEP_ID,\n      bundleVersion: process.env.CEP_VERSION,\n      hosts: process.env.CEP_HOSTS,\n      iconNormal: process.env.CEP_ICON_NORMAL,\n      iconRollover: process.env.CEP_ICON_ROLLOVER,\n      iconDarkNormal: process.env.CEP_ICON_DARK_NORMAL,\n      iconDarkRollover: process.env.CEP_ICON_DARK_ROLLOVER,\n      panelWidth: process.env.CEP_PANEL_WIDTH,\n      panelHeight: process.env.CEP_PANEL_HEIGHT,\n      debugPorts: debugPortEnvs.length > 0\n        ? debugPortEnvs.reduce((obj, key) => {\n          obj[key] = parseInt(process.env[key], 10)\n          return obj\n        }, {})\n        : undefined,\n      debugInProduction: isTruthy(process.env.CEP_DEBUG_IN_PRODUCTION) || undefined,\n      cefParams: !process.env.CEP_CEF_PARAMS ? undefined : process.env.CEP_CEF_PARAMS.split(',')\n    },\n    {\n      bundleName: pkgConfig.name,\n      bundleId: pkgConfig.id,\n      bundleVersion: pkgConfig.version,\n      hosts: pkgConfig.hosts,\n      iconNormal: pkgConfig.iconNormal,\n      iconRollover: pkgConfig.iconRollover,\n      iconDarkNormal: pkgConfig.iconDarkNormal,\n      iconDarkRollover: pkgConfig.iconDarkRollover,\n      panelWidth: pkgConfig.panelWidth,\n      panelHeight: pkgConfig.panelHeight,\n      debugPorts: pkgConfig.debugPorts,\n      debugInProduction: pkgConfig.debugInProduction,\n      lifecycle: pkgConfig.lifecycle,\n      cefParams: pkgConfig.cefParams\n    },\n    {\n      bundleVersion: pkg.version,\n    },\n    {\n      bundleName: 'Parcel CEP Extension',\n      bundleId: 'com.mycompany.myextension',\n      bundleVersion: '0.0.1',\n      hosts: '*',\n      panelWidth: 500,\n      panelHeight: 500,\n      debugInProduction: false,\n      debugPorts: {\n        PHXS: 3001,\n        IDSN: 3002,\n        AICY: 3003,\n        ILST: 3004,\n        PPRO: 3005,\n        PRLD: 3006,\n        AEFT: 3007,\n        FLPR: 3008,\n        AUDT: 3009,\n        DRWV: 3010,\n        MUST: 3011,\n        KBRG: 3012,\n      },\n      lifecycle: { autoVisible: true, startOnEvents: [] },\n      cefParams: [\n        '--allow-file-access-from-files',\n        '--allow-file-access',\n        '--enable-nodejs',\n        '--mixed-context'\n      ]\n    }\n  )\n  return config\n}\n\nexport function objectToProcessEnv(object) {\n  // assign object to process.env so they can be used in the code\n  Object.keys(object).forEach(key => {\n    const envKey = camelToSnake(key).toUpperCase()\n    const value = typeof object[key] === 'string'\n      ? object[key]\n      : JSON.stringify(object[key])\n    process.env[envKey] = value\n  })\n}\n\nexport function writeExtensionTemplates({\n  isDev,\n  devPort,\n  devHost,\n  hosts,\n  debugPorts,\n  out,\n  htmlFilename,\n  bundleName,\n  bundleId,\n  bundleVersion,\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover,\n  panelWidth,\n  panelHeight,\n  debugInProduction,\n  lifecycle,\n  cefParams\n}) {\n  const manifestContents = manifestTemplate({\n    isDev,\n    bundleName,\n    bundleId,\n    version: bundleVersion,\n    hosts,\n    bundleVersion,\n    iconNormal,\n    iconRollover,\n    iconDarkNormal,\n    iconDarkRollover,\n    panelWidth,\n    panelHeight,\n    lifecycle,\n    cefParams\n  })\n  const manifestDir = path.join(out, 'CSXS')\n  const manifestFile = path.join(manifestDir, 'manifest.xml')\n  return Promise.resolve()\n    .then(() => fs.ensureDir(manifestDir))\n    .then(() => fs.writeFile(manifestFile, manifestContents))\n    .then(() => {\n      let chain = Promise.resolve()\n      if (debugInProduction || isDev) {\n        const debugContents = debugTemplate(bundleId, debugPorts)\n        chain = chain.then(() => fs.writeFile(path.join(out, '.debug'), debugContents))\n      }\n      const href = !isDev ? htmlFilename : `http://${devHost}:${devPort}`\n      const panelContents = panelTemplate({\n        title: bundleName,\n        href\n      })\n      chain = chain.then(() => fs.writeFile(path.join(out, 'panel.html'), panelContents))\n      return chain\n    })\n}\n\nexport function parseHosts(hostsString) {\n  if (hostsString == '*')\n    hostsString = `PHXS, IDSN, AICY, ILST, PPRO, PRLD, AEFT, FLPR, AUDT, DRWV, MUST, KBRG`\n  const hosts = hostsString\n    .split(/(?![^)(]*\\([^)(]*?\\)\\)),(?![^\\[]*\\])/)\n    .map(host => host.trim())\n    .map(host => {\n      let [name, version] = host.split('@')\n      if (version == '*' || !version) {\n        version = '[0.0,99.9]'\n      } else if (version) {\n        version = version\n      }\n      return {\n        name,\n        version,\n      }\n    })\n  return hosts\n}\n\nexport function getExtenstionPath() {\n  if (process.platform == 'darwin') {\n    return path.join(\n      os.homedir(),\n      '/Library/Application Support/Adobe/CEP/extensions'\n    )\n  } else if (process.platform == 'win32') {\n    return path.join(process.env.APPDATA, 'Adobe/CEP/extensions')\n  }\n}\n\nfunction getSymlinkExtensionPath({ bundleId }) {\n  const extensionPath = getExtenstionPath()\n  return path.join(extensionPath, bundleId)\n}\n\nexport function symlinkExtension({ bundleId, out }) {\n  const target = getSymlinkExtensionPath({ bundleId })\n  return Promise.resolve()\n    .then(() => fs.ensureDir(getExtenstionPath()))\n    .then(() => fs.remove(target))\n    .then(() => {\n      if (process.platform === 'win32') {\n        return fs.symlink(path.join(out, '/'), target, 'junction')\n      } else {\n        return fs.symlink(path.join(out, '/'), target)\n      }\n    })\n}\n\nexport function copyDependencies({ root, out, pkg }) {\n  const deps = pkg.dependencies || {}\n  return Object.keys(deps).reduce((chain, dep) => {\n    const src = path.join(root, 'node_modules', dep)\n    const dest = path.join(out, 'node_modules', dep)\n    let exists = false\n    try {\n      exists = fs.statSync(dest).isFile();\n    }\n    catch (err) {}\n    if (!exists) {\n      chain = chain\n        .then(() => fs.copy(src, dest))\n        .catch(() => {\n          console.error(\n            `Could not copy ${src} to ${dest}. Ensure the path is correct.`\n          )\n        })\n        .then(() => copyDependencies({\n          root,\n          out,\n          pkg: fs.readJsonSync(path.join(root, 'node_modules', dep, 'package.json'))\n        }))\n      return chain\n    }\n    return chain\n  }, Promise.resolve())\n}\n\nexport function copyIcons({ root, out, config }) {\n  const iconPaths = [\n    config.iconNormal,\n    config.iconRollover,\n    config.iconDarkNormal,\n    config.iconDarkRollover,\n  ]\n    .filter(icon => icon !== undefined)\n    .map(icon => ({\n        source: path.resolve(root, icon),\n        output: path.join(out, path.relative(root, icon)),\n    }))\n  return Promise.all(\n    iconPaths.map(icon => {\n      return fs.copy(icon.source, icon.output)\n        .catch(() => {\n          console.error(\n            `Could not copy ${icon.source}. Ensure the path is correct.`\n          )\n        })\n    })\n  )\n}\n\nexport function compile(opts) {\n  opts.env = opts.env ? opts.env : process.env.NODE_ENV\n  opts.root = opts.root ? opts.root : process.cwd()\n  opts.htmlFilename = opts.htmlFilename ? opts.htmlFilename : 'index.html'\n  opts.pkg = opts.pkg ? opts.pkg : require(path.join(opts.root, '/package.json'))\n  opts.devHost = opts.devHost ? opts.devHost : 'localhost'\n  opts.hasOwnProperty('isDev') ? opts.isDev : true\n  const config = getConfig(opts.pkg, opts.env)\n  const hosts = parseHosts(config.hosts)\n  let chain = Promise.resolve()\n  if (opts.isDev) {\n    enablePlayerDebugMode()\n    if (!config.noSymlink) {\n      chain = chain.then(() =>\n        symlinkExtension({ bundleId: config.bundleId, out: opts.out })\n      )\n    }\n  }\n  chain = chain.then(() =>\n    copyDependencies({ root: opts.root, out: opts.out, pkg: opts.pkg })\n  ).then(() =>\n    writeExtensionTemplates({\n      hosts,\n      isDev: opts.isDev,\n      devPort: opts.devPort,\n      devHost: opts.devHost,\n      htmlFilename: opts.htmlFilename,\n      bundleName: config.bundleName,\n      bundleId: config.bundleId,\n      bundleVersion: config.bundleVersion,\n      iconNormal: config.iconNormal,\n      iconRollover: config.iconRollover,\n      iconDarkNormal: config.iconDarkNormal,\n      iconDarkRollover: config.iconDarkRollover,\n      panelWidth: config.panelWidth,\n      panelHeight: config.panelHeight,\n      debugPorts: config.debugPorts,\n      debugInProduction: config.debugInProduction,\n      cefParams: config.cefParams,\n      lifecycle: config.lifecycle,\n      cefParams: config.cefParams,\n      out: opts.out,\n    })\n  )\n  .then(() =>\n    copyIcons({ root: opts.root, out: opts.out, config })\n  )\n  return chain\n}"],"names":["bundleName","bundleId","version","hosts","bundleVersion","cepVersion","panelWidth","panelHeight","cefParams","iconNormal","iconRollover","iconDarkNormal","iconDarkRollover","lifecycle","commandLineParams","map","cefParam","icons","icon","type","filter","join","startOn","startOnEvents","length","e","host","name","autoVisible","title","href","debugPorts","Object","keys","trim","templateDebug","formatter","range","os","EOL","enablePlayerDebugMode","process","platform","execSync","i","disablePlayerDebugMode","camelToSnake","str","replace","part","toLowerCase","isTruthy","getConfig","pkg","env","debugPortEnvs","key","indexOf","pkgConfig","hasOwnProperty","cep","config","defaultsDeep","CEP_NAME","CEP_ID","CEP_VERSION","CEP_HOSTS","CEP_ICON_NORMAL","CEP_ICON_ROLLOVER","CEP_ICON_DARK_NORMAL","CEP_ICON_DARK_ROLLOVER","CEP_PANEL_WIDTH","CEP_PANEL_HEIGHT","reduce","obj","parseInt","undefined","debugInProduction","CEP_DEBUG_IN_PRODUCTION","CEP_CEF_PARAMS","split","id","PHXS","IDSN","AICY","ILST","PPRO","PRLD","AEFT","FLPR","AUDT","DRWV","MUST","KBRG","objectToProcessEnv","object","forEach","envKey","toUpperCase","value","JSON","stringify","writeExtensionTemplates","isDev","devPort","devHost","out","htmlFilename","manifestContents","manifestTemplate","manifestDir","path","manifestFile","Promise","resolve","then","fs","ensureDir","writeFile","chain","debugContents","debugTemplate","panelContents","panelTemplate","parseHosts","hostsString","getExtenstionPath","homedir","APPDATA","getSymlinkExtensionPath","extensionPath","symlinkExtension","target","remove","symlink","copyDependencies","root","deps","dependencies","dep","src","dest","exists","statSync","isFile","err","copy","console","error","readJsonSync","copyIcons","iconPaths","source","output","relative","all","compile","opts","NODE_ENV","cwd","require","noSymlink"],"mappings":"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"}